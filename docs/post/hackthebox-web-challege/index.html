<!DOCTYPE html>
<html lang="en">

<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# website: http://ogp.me/ns/website#">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="description" content="">
    <meta property="og:title" content="[hackthebox.eu] Web Challenge">
    
    <meta property="og:type" content="article">
    <meta property="article:published_time" content="2019-01-15">
    
    <meta property="og:description" content="">
    <meta property="og:url" content="https://saddean.github.io/blogs/post/hackthebox-web-challege/">
    <meta property="og:site_name" content="S4D&#39;s Blog">
    
    <meta property="og:tags" content="CTF">
    
    <meta property="og:tags" content="hackthebox.eu">
    
    <meta name="generator" content="Hugo 0.52" />
    <title>[hackthebox.eu] Web Challenge &middot; S4D&#39;s Blog</title>
    
    <link rel="stylesheet" href="https://saddean.github.io/blogs/css/monokai-sublime.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="stylesheet" href="https://saddean.github.io/blogs/css/style.css">
    <link rel="stylesheet" type="text/css" href="https://csshake.surge.sh/csshake.min.css">
    
    <link href="https://saddean.github.io/blogs/index.xml" rel="alternate" type="application/rss+xml" title="S4D&#39;s Blog" />
    
    
    <link rel="icon" href="https://saddean.github.io/blogs/icon.ico" />
    

    
    
</head>

<body>
<nav class="navbar navbar-default navbar-fixed-top visible-xs">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
				<a class="navbar-brand" href="https://saddean.github.io/blogs/">$4D</a>
			
		</div>
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				
				
					<li><a href="https://saddean.github.io/blogs/about">About</a></li>
				
					<li><a href="https://saddean.github.io/blogs/">Blog</a></li>
				
					<li><a href="https://saddean.github.io/blogs/tags/">Category</a></li>
				
			</ul>
		</div>
	</div>
</nav>
<div class="container-fluid">
	<div class="row">
		<div id="menu" class="hidden-xs col-sm-2 col-md-2">
	<div id="menu-content" class="vertical-align">
		
			<h2 class="text-center rainbox-text shake-opacity"><a href="https://saddean.github.io/blogs/">$4D</a></h2>
		
		
		
			<small class="text-center center-block">üöÄ Ng∆∞·ªùi ƒëi ra ngo√†i v≈© tr·ª• üöÄ</small>
		
		
		
			<img id="profile-pic" src="https://saddean.github.io/blogs//img/profile.jpg" alt="My Picture" class="img-circle center-block">
		
		<div id="social" class="text-center">
			
				<a href="https://github.com/saddean"><i class="shake-opacity fa fa-github fa-3x"></i></a>
			
				<a href="https://twitter.com/ttuongann"><i class="shake-opacity fa fa-twitter fa-3x"></i></a>
			
				<a href="https://facebook.com/ttuongann"><i class="shake-opacity fa fa-facebook fa-3x"></i></a>
			

			
		</div>
		<div id="links" class="text-center">
			
			
				<a href="https://saddean.github.io/blogs/about">About</a>
			
				<a href="https://saddean.github.io/blogs/">Blog</a>
			
				<a href="https://saddean.github.io/blogs/tags/">Category</a>
			
		</div>
	</div>
</div>

		<div id="content" class="col-xs-12 col-sm-8 col-md-10">
			<div class="row">
				<div id="post" class="col-sm-offset-1 col-sm-10 col-md-10 col-lg-9">

<main>
	<header>
		<h1 class="title-h1">[hackthebox.eu] Web Challenge</h1>
		<div>
			Published on: <i class="hg-muted">15 January 2019</i>
		</div>
		<div>
			<i>Tags:</i>
			<small class="text-muted">
				
				
				<a href="https://saddean.github.io/blogs/tags/ctf"><span class="label btn-warning shake-opacity">CTF</span></a>
				
				<a href="https://saddean.github.io/blogs/tags/hackthebox.eu"><span class="label btn-warning shake-opacity">hackthebox.eu</span></a>
				
			</small>
		</div>
	</header>

	<article>
		

<hr />

<h1 id="list-of-challage">#.LIST OF CHALLAGE</h1>

<table>
<thead>
<tr>
<th>ID</th>
<th>Challgenge</th>
<th>Done</th>
</tr>
</thead>

<tbody>
<tr>
<td><strong>1</strong></td>
<td><a href="#1"><strong>[30 Points] HDC</strong></a></td>
<td>‚úÖ</td>
</tr>

<tr>
<td><strong>2</strong></td>
<td><a href="#2"><strong>[50 Points] I know Mag1k</strong></a></td>
<td>‚úÖ</td>
</tr>

<tr>
<td><strong>3</strong></td>
<td><a href="#3"><strong>[70 Points] Grammar</strong></a></td>
<td>‚úÖ</td>
</tr>

<tr>
<td><strong>4</strong></td>
<td><a href="#4"><strong>[20 Points] Lernaean</strong></a></td>
<td>‚úÖ</td>
</tr>

<tr>
<td><strong>5</strong></td>
<td><a href="#5"><strong>[30 Points] Cartographer</strong></a></td>
<td>‚úÖ</td>
</tr>
</tbody>
</table>

<hr />

<p><a name="1"></a></p>

<h1 id="1-hdc-by-thiseas">1.HDC [by Thiseas]</h1>

<blockquote>
<p><strong>Description</strong> : We believe a certain individual uses this website for shady business. Can you find out who that is and send him an email to check, using the web site&rsquo;s functionality? Note: The flag is not an e-mail address.</p>
</blockquote>

<p>M·ªü ƒë·∫ßu Chall l√† hai √¥ input nh·∫≠p v√†o username/password
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/hdc1.jpg" class="img-responsive">
Tuy nhi√™n khi view-source th√¨ th·∫•y 2 input type <code>hidden</code> üëÄ kh√° ƒë√°ng ng·ªù , check ti·∫øp h√†m <code>doProcess()</code> trong <code>myscript.js</code>
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/hdc3.jpg" class="img-responsive">
Ch·∫£ c√≥ g√¨ ƒë·∫∑c bi·ªát&hellip;Ch·ªâ l√† h√†m submit form b√¨nh th∆∞·ªùng , loay hoay debug b·∫±ng <code>DevTools</code> c≈©ng ch∆∞a th·∫•y g√¨ ƒë·∫∑c bi·ªát.
L√∫c n√†y c√≥ hai √¥ input type <code>hidden</code> check c√°c ki·ªÉu th√¨ th·∫•y form k s·ª≠ d·ª•ng 2 th·∫±ng n√†y, m√≤ m·ªôt h·ªìi th√¨ th·∫•y trong lib jquery c√≥ 1 h√†m
<code>doProcess()</code> n·ªØa
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/hdc4.jpg" class="img-responsive">
S·ª≠ d·ª•ng username/password ƒë∆∞·ª£c set trong h√†m n√†y submit form th√¨ login th√†nh c√¥ng ^^
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/hdc2.jpg" class="img-responsive">
B·∫•m lung tung m·ªôt h·ªìi c≈©ng ch∆∞a ki·∫øm ƒë∆∞·ª£c c√°i mail chall y√™u c·∫ßu, check l·∫°i burpsuite th√¨ th·∫•y c√≥ link l·∫° <code>/main/secret_area_/</code>.
M·ªü ra th√¨ c√≥ <code>mail.txt</code>. L√∫c n√†y k ph·∫£i 1 mail n·ªØa m√† l√† c·∫£ 18 c√°i mail ƒë·ªÉ test :| Kh√¥ng th√≠ch l·∫Øm nh∆∞ng bruteforce th√¥i.
Ti·∫øn th√†nh bruteforce b·∫±ng form g·ª≠i mail, setup v·ªõi burpsuite cho l·∫π kh·ªèi ph·∫£i code :D
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/hd5.jpg" class="img-responsive">
DONE! C√≥ Flag submit!!</p>

<hr />

<p><a name="2"></a></p>

<h1 id="2-i-know-mag1k-by-rkmylo">2.I know Mag1k [by rkmylo]</h1>

<blockquote>
<p><strong>Description</strong> : Can you get to the profile page of the admin?</p>
</blockquote>

<p><img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/Mag1k1.jpg" class="img-responsive">
M·ªõi v√†o chall m√¨nh ng·ªôp h·∫≥n :| m√¨nh k c√≥ kinh nghi·ªám m·∫•y trong khai th√°c <code>sqlinjection</code> l·∫Øm, ƒëc hint t·ª´ m·ªôt ng∆∞·ªùi b·∫°n th√¨ m√¨nh bi·∫øt
b√†i n√†y d·∫°ng <code>decrypt</code> v√† s·ª≠ d·ª•ng <code>padbuster</code>.<br>
T·∫°o m·ªôt acc r·ªìi login v√†o xem cookie c·ªßa trang c·∫•p l√† g√¨
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/Mag1k2.jpg" class="img-responsive">
Ok t√¨m ra cookie c√≥ t√™n l√† <code>iknowmag1k</code>
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/Mag1k3.jpg" class="img-responsive">
C√≥ hint r·ªìi l√† d√πng lu√¥n <code>padbuster</code> r·ªìi th√¨ ch∆°i th√¥i :D
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/Mag1k4.jpg" class="img-responsive">
:) ƒë·ªát qu√° tr√¨nh l√¢u h∆°n m√¨nh nghƒ© cu·ªëi c√πng c≈©ng decrypt ra ƒëc session</p>

<pre><code class="language-json">{&quot;user&quot;:&quot;admin&quot;,&quot;role&quot;:&quot;user&quot;}
</code></pre>

<p>Ti·∫øn h√†nh d√πng <code>padbuster</code> m·ªôt l·∫ßn n·ªØa ƒë·ªÉ t·∫°o ra session fake <code>{&quot;user&quot;:&quot;admin&quot;,&quot;role&quot;:&quot;admin&quot;}</code> (username m√¨nh t·∫°o l√† admin nh√© ^^)
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/mag1k5.jpg" class="img-responsive"></p>

<ul>
<li><strong>Note</strong>: <a href="https://www.owasp.org/index.php/Testing_for_Padding_Oracle_(OTG-CRYPST-002)">Padding Oracle Attacks</a></li>
</ul>

<hr />

<p><a name="3"></a></p>

<h1 id="3-grammar-by-forgp">3.Grammar [by forGP]</h1>

<blockquote>
<p><strong>Description</strong> : When we access this page we get a Forbidden error. However we believe that something strange lies behind&hellip; Can you find a way in and retrieve the flag?</p>
</blockquote>

<p>D·ª±a v√†o g·ª£i √Ω v√† kinh nghi·ªám ch∆°i khi th·∫•y ƒë·∫ßu chall v√† hint l√† <code>Forbidden error</code> th√¨ nghƒ© ngay ƒë·∫øn ƒë·ªïi method c·ªßa request
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/Grammar0.jpg" class="img-responsive">
B·∫±ng m·ªôt s·ªë bi·ªán ph√°p fuzz nh·∫π th√¨ ph√°t hi·ªán trang <code>index.php</code>, ƒë·ªïi method th√†nh <code>POST</code> v√† pass th√†nh c√¥ng
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/Grammar3.jpg" class="img-responsive">
Trang n√†y c≈©ng k c√≥ g√¨ ƒë·∫∑c bi·ªát , th·ª≠ submit form c≈©ng ko c√≥ g√¨ thay ƒë·ªïi
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/Grammar1.jpg" class="img-responsive">
L∆∞·ªõt s∆° v√¥ session, th√¨ th·∫•y t√™n session kh√° l·∫°, th∆∞·ªùng session c·ªßa PHP th∆∞·ªùng l√† <code>PHPSESSID</code> m√† ·ªü ƒë√¢y l·∫°i l√† <code>ses</code> üçå
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/Grammar2.jpg" class="img-responsive">
basecode64 th√¥i</p>

<pre><code class="language-javascript">&quot;eyJVc2VyIjoic2FkZGVhbiIsIkFkbWluIjoiRmFsc2UiLCJNQUMiOiI0NjFiOWUwNGRmOTQwY2NlMWUyMDhlMjNiOTFjYzAxYSJ9==&quot;
//output: {&quot;User&quot;:&quot;saddean&quot;,&quot;Admin&quot;:&quot;False&quot;,&quot;MAC&quot;:&quot;461b9e04df940cce1e208e23b91cc01a&quot;}

//change json: `{&quot;User&quot;:&quot;saddean&quot;,&quot;Admin&quot;:&quot;True&quot;,&quot;MAC&quot;:&quot;461b9e04df940cce1e208e23b91cc01a&quot;}`
&quot;eyJVc2VyIjoic2FkZGVhbiIsIkFkbWluIjoiVHJ1ZSIsIk1BQyI6IjQ2MWI5ZTA0ZGY5NDBjY2UxZTIwOGUyM2I5MWNjMDFhIn0=&quot;
</code></pre>

<p>ƒê·ªùi kh√¥ng nh∆∞ m∆° üòÇ
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/Grammar4.jpg" class="img-responsive">
Nh√¨n tho√°ng th√¨ trong ƒëo·∫°n decode c√≤n 1 tham s·ªë MAC, ch·∫Øc c√≥ v·∫ª d√πng ƒë·ªÉ matching v·ªõi server, N·∫øu ai hay vi·∫øt API cho <code>ReactJS</code> th√¨ ch·∫Øc ko l·∫° g√¨ v·ªõi c√°i n√†y n·ªØa.
C·ª• th·ªÉ <code>MAC</code> kia gi·ªëng nh∆∞ m·ªôt <code>integrity key</code> ƒë·ªÉ ki·ªÉm tra t√≠nh ƒë√∫ng ƒë·∫Øn c·ªßa json, kh√≥ ƒë·ªÉ m√† t·∫°o l·∫°i c√°i <code>MAC</code> ƒë√≥ v√¨ c√≥ th·ªÉ c√≥ <code>secret key</code>&hellip;.Tuy nhi√™n v·ªõi m·ªôt ng∆∞·ªùi theo ch·ªß nghƒ©a ko th√≠ch <code>PHP</code>
nh∆∞ m√¨nh v√¨ n√≥ ƒë√¥i khi c√≥ m·ªôt s·ªë l·ªói r·∫•t k√¨ l·∫° n√™n m√¨nh t√¨m th·ª≠ l·ªói bypass n√≥.<br>
&ndash; Sau qu√° tr√¨nh search th√¨ m√¨nh th·∫•y c√≥ slide n√†y kh√° h·ªØu √≠ch <a href="https://hydrasky.com/network-security/php-string-comparison-vulnerabilities/">LINK1</a> <a href="https://www.owasp.org/images/6/6b/PHPMagicTricks-TypeJuggling.pdf">LINK2</a></p>

<p>C·ª• th·ªÉ: N·∫øu b·∫°n nh√¨n k·ªπ MAC ƒëang l√† d·∫°ng <code>String</code>, c√≥ th·ªÉ trong source code ƒëang d√πng h√†m stcmp ho·∫∑c == ƒë·ªÉ so s√°nh. M·ªôt v√≠ d·ª• nh·ªè:</p>

<pre><code class="language-php">    TRUE: ‚Äú0000‚Äù == int(0)
    TRUE: ‚Äú0e12‚Äù == int(0)
    TRUE: ‚Äú1abc‚Äù == int(1)
    TRUE: ‚Äú0abc‚Äù == int(0)
    TRUE: ‚Äúabc‚Äù == int(0)       --&gt; L·ªñI XU·∫§T PH√ÅT CH·ªñ N√ÄY N√à M·∫§Y B·∫†N
--------------------------------------------------------------------
    &quot;7a5c2...45dsd&quot; == int(7)
    &quot;68f66...8dsdw&quot; == int(68)
    &quot;092dcs...54de3&quot; == int(92)
    --&gt; C√≥ th·ªÉ ƒëo√°n v√† pass ƒë∆∞·ª£c hash_mac d·ª±a v√†o s·ªë ƒë·∫ßu
</code></pre>

<p>Gi·∫£i th√≠ch ƒë∆°n gi·∫£i ƒë√¢y l√† l·ªói so s√°nh gi·ªØ String v√† Int. V·ªõi tr∆∞·ªùng h·ª£p b√†i n√†y, th√¨ c√°c b·∫°n nh√¨n th·∫•y <code>MAC</code> trong json l√† ki·ªÉu <code>String</code> √°p d·ª•ng thay ƒë·ªïi MAC b·∫±ng <code>0</code> ki·ªÉu Int th√¥i</p>

<pre><code class="language-php">{&quot;User&quot;:&quot;saddean&quot;,&quot;Admin&quot;:&quot;True&quot;,&quot;MAC&quot;:0}
//output basecode64: eyJVc2VyIjoic2FkZGVhbiIsIkFkbWluIjoiVHJ1ZSIsIk1BQyI6MH0=
</code></pre>

<p>Ti·∫øn h√†nh request l√™n b·∫±ng session m·ªõi hoii, k·∫øt qu·∫£ thu ƒë∆∞·ª£c flag
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/Grammar5.jpg" class="img-responsive"></p>

<hr />

<p><a name="4"></a></p>

<h1 id="4-lernaean-by-arrexel">4.Lernaean [by Arrexel]</h1>

<blockquote>
<p><strong>Description</strong> : Your target is not very good with computers. Try and guess their password to see if they may be hiding anything!</p>
</blockquote>

<p>M·ªõi v√¥ chall th√¨ m√¨nh nghƒ© l√† <code>sqlinjection</code> ƒë·ªÉ bypass auth, sau m·ªôt h·ªìi test th√¨ b·ªã cu·ªën v√¥ injection c·∫£ ti·∫øng m√£i ko ra ü§£üòÇ B√¨nh tƒ©nh view-source th√¨ th·∫•y v√†i c√¢u n√≥i c√≥ v·∫ª l√† hint <code>Please do not try to guess my password!</code>. Brute-force th√¥i, recommend s·ª≠ d·ª•ng seclist top 1000 l√† ƒë·ªß r·ªìi. <a href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/darkweb2017-top1000.txt">LINK</a> &ndash;&gt; ch·ªù ƒë·ª£i ra pass th√¥i.<br>
Nh·∫≠p pass v√† üí£:<br>
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/Lernaean1.jpg" class="img-responsive">
<br>
Ez , t·∫Øt javascript tr√™n browser ƒëi th√¥i :D <br>
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/Lernaean2.jpg" class="img-responsive"></p>

<hr />

<p><a name="5"></a></p>

<h1 id="5-cartographer-by-arrexel">5.Cartographer [by Arrexel]</h1>

<blockquote>
<p><strong>Description</strong> : Some underground hackers are developing a new command and control server. Can you break in and see what they are up to?</p>
</blockquote>

<p>L·∫°i l√† ƒëƒÉng nh·∫≠p üëÄ<br>
M·ªõi z√¥ phang th·ª≠ sqlinjection ai ng·ªù ƒë∆∞·ª£c lu√¥n üçåüçå
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/carto1.jpg" class="img-responsive">
- <strong>Payload:</strong> <code>username=admin%27+union+select+1--+-&amp;password=1</code>
Chall n√†y th∆∞ gi√£n h∆°n so v·ªõi c√°i tr∆∞·ªõc, nh√¨n v√¥ ƒëo√°n lu√¥n ƒëc
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/carto2.jpg" class="img-responsive">
Chuy·ªÉn <code>Home</code> th√†nh <code>flag</code> l√† c√≥ ƒë∆∞·ª£c flag lu√¥n
<img src="https://raw.githubusercontent.com/saddean/blogs/master/static/img/hackthebox/carto3.jpg" class="img-responsive"></p>

	</article>
</main>

<div id="bottom-nav" class="text-center center-block">
	<a href=" https://saddean.github.io/blogs/" class="btn btn-default"><i class="fa fa-home"></i> Home</a>
</div>


<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "myblog-wqnng8opme" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


						</div>
					</div>
				</div>
			</div>
		</div>
  </div>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-130213932-1', 'auto');
    ga('send', 'pageview');
    window.baseURL = "https:\/\/saddean.github.io\/blogs\/";
  </script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script>
  <script src="https://saddean.github.io/blogs//js/App.js"></script>
  
</body>
</html>